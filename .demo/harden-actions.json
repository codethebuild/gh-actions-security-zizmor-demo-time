{
  "$schema": "https://demotime.show/demo-time.schema.json",
  "title": "Harden GitHub Actions with Zizmor",
  "description": "Security demos and demonstrations for hardening GitHub Actions workflows",
  "version": 2,
  "variables": [
    {
      "name": "ZIZMOR_TERMINAL_WAIT_TIME",
      "description": "Wait time after zizmor command execution",
      "default": 3000
    }
  ],
  "demos": [
    {
      "id": "add-workflows",
      "title": "ðŸ”’ Add workflows for zizmor and dependencies review",
      "description": "Add security workflows to your repository to run zizmor and dependency review actions",
      "icons": {
        "start": "shield",
        "end": "pass-filled"
      },
      "steps": [
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "openTerminal",
          "terminalId": "git"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "BRANCH_NAME=security/harden-workflows-$(date +%s) && git checkout -b $BRANCH_NAME && echo $BRANCH_NAME > /tmp/demo-branch-name",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "showInfoMessage",
          "message": "ðŸ”’ Adding zizmor security workflow to scan GitHub Actions..."
        },
        {
          "action": "create",
          "path": ".github/workflows/zizmor.yml"
        },
        {
          "action": "insert",
          "path": ".github/workflows/zizmor.yml",
          "position": "1",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 10,
          "content": "name: GitHub Actions Security Analysis with zizmor\n\non:\n  push:\n    branches: [\"main\"]\n    paths:\n      - \".github/workflows/**\"\n  pull_request:\n    branches: [\"**\"]\n    paths:\n      - \".github/workflows/**\"\n\npermissions: {}\n\nconcurrency:\n  group: ${{ github.workflow }}-${{ github.ref }}\n  cancel-in-progress: true\n\njobs:\n  zizmor:\n    name: Run zizmor\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read\n      actions: read           # to read actions in status in the repo\n      security-events: write  # to create security alerts\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v6.0.0\n        with:\n          persist-credentials: false\n\n      - name: Run zizmor\n        uses: zizmorcore/zizmor-action@e673c3917a1aef3c65c972347ed84ccd013ecda4 # v0.2.0\n        with:\n          persona: pedantic\n          advanced-security: false\n          annotations: true\n"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/workflows/zizmor.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "showInfoMessage",
          "message": "âœ… zizmor workflow added and staged for commit!"
        },
        {
          "action": "waitForTimeout",
          "timeout": 10000
        },
        {
          "action": "showInfoMessage",
          "message": "ðŸ”’ Adding dependency review workflow to scan dependencies..."
        },
        {
          "action": "create",
          "path": ".github/workflows/dependency-review.yml"
        },
        {
          "action": "insert",
          "path": ".github/workflows/dependency-review.yml",
          "position": "1",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 10,
          "content": "name: 'Dependency Review'\non: [pull_request]\n\nconcurrency:\n  group: ${{ github.workflow }}-${{ github.ref }}\n  cancel-in-progress: true\n\npermissions: {}\n\njobs:\n  dependency-review:\n    name: Dependency vulnerability scan\n    runs-on: ubuntu-latest\n    permissions:\n      contents: read        # for actions/checkout\n      pull-requests: write  # for actions/dependency-review-action to comment on PRs\n    steps:\n      - name: 'Checkout Repository'\n        uses: actions/checkout@v6.0.0\n        with:\n          persist-credentials: false\n      - name: 'Dependency Review'\n        uses: actions/dependency-review-action@3c4e3dcb1aa7874d2c16be7d79418e9b7efd6261 # v4.8.2\n        with:\n          comment-summary-in-pr: always"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/workflows/dependency-review.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "showInfoMessage",
          "message": "âœ… Dependency review workflow added and staged for commit!"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git commit -m 'Add security workflows: zizmor and dependency review'",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "BRANCH_NAME=$(cat /tmp/demo-branch-name) && git push -u origin $BRANCH_NAME",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "gh pr create --title 'chore(demo): Harden actions' --body 'This PR is harden GitHub Actions workflows by adding security analysis with zizmor and dependency review.'  --assignee @me",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 20
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "gh pr view --web",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "showInfoMessage",
          "message": "âœ… Pull request created! Security workflows are ready for review."
        }
      ]
    },
    {
      "id": "add-cooldown",
      "title": "ðŸ”’ Add Cooldown to Dependabot",
      "description": "Add a cooldown period to Dependabot updates",
      "icons": {
        "start": "shield",
        "end": "pass-filled"
      },
      "steps": [
        {
          "action": "open",
          "path": ".github/dependabot.yml"
        },
        {
          "action": "insert",
          "path": ".github/dependabot.yml",
          "position": "18",
          "content": "    cooldown:\n      default-days: 7",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 70
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/dependabot.yml",
          "position": "18:19"
        },
        {
          "action": "save"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/dependabot.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git commit -m 'chore: Add cooldown period to Dependabot'",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        }
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git push",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        }
      ]
    },
    {
      "id": "lock-actions",
      "title": "ðŸ”’ Update and lock actions",
      "description": "Pin GitHub Actions to specific versions and SHAs",
      "icons": {
        "start": "shield",
        "end": "pass-filled"
      },
      "steps": [
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "command": "clear && zizmor .",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50,
          "terminalId": "demo"
        },
        {
          "action": "waitForTimeout",
          "timeout": 20000
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "open",
          "path": ".github/workflows/ci.yml"
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "16,31:16,38",
          "content": "v6.0.0",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "16"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "19,33:19,40",
          "content": "v6.0.0",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "19"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "28,38:28,89",
          "content": "556a3fdaf8b4201d4d74d406013386aa4f7dab96 # v1.34.0",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 30
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "28"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "52,38:52,45",
          "content": "v5.0.0",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "52"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "59,38:59,45",
          "content": "v5.0.0",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "59"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "save"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/workflows/ci.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git commit -m 'chore: Pin GitHub Actions to specific versions'",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git push",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        }
      ]
    },
    {
      "id": "permissions-workflow",
      "title": "ðŸ”’ Limit permission",
      "description": "Add least-privilege permissions to GitHub Actions workflow",
      "icons": {
        "start": "shield",
        "end": "pass-filled"
      },
      "steps": [
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "command": "clear &&zizmor .",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50,
          "terminalId": "demo"
        },
        {
          "action": "waitForTimeout",
          "timeout": 20000
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "insert",
          "path": ".github/workflows/ci.yml",
          "position": "8",
          "insertTypingMode": "line-by-line",
          "insertTypingSpeed": 500,
          "content": "\npermissions: {}\n"
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "9"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "insert",
          "path": ".github/workflows/ci.yml",
          "position": "15",
          "insertTypingMode": "line-by-line",
          "insertTypingSpeed": 500,
          "content": "\n    permissions:\n      contents: read\n      pull-requests: write\n"
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "16:18"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "insert",
          "path": ".github/workflows/ci.yml",
          "position": "23",
          "insertTypingMode": "line-by-line",
          "insertTypingSpeed": 500,
          "content": "        with:\n          persist-credentials: false\n"
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "23:24"
        },
        {
          "action": "save"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/workflows/ci.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git commit -m 'chore: Add least-privilege permissions to CI workflow'",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git push",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "command": "clear && zizmor .",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50,
          "terminalId": "demo"
        },
        {
          "action": "waitForTimeout",
          "timeout": 10000
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        }
      ]
    },
    {
      "id": "pandemic-mode",
      "title": "âœ… Complete Hardening",
      "description": "Add comments and concurrency to complete hardening",
      "icons": {
        "start": "shield",
        "end": "pass-filled"
      },
      "steps": [
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "command": "clear && zizmor -p --gh-token $(gh auth token) .",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50,
          "terminalId": "demo"
        },
        {
          "action": "waitForTimeout",
          "timeout": 20000
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "replace",
          "path": ".github/workflows/ci.yml",
          "position": "18,33:18,33",
          "content": " # required for reviewdog to make comments",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "18"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "insert",
          "path": ".github/workflows/ci.yml",
          "position": "10",
          "insertTypingMode": "line-by-line",
          "insertTypingSpeed": 500,
          "content": "\nconcurrency:\n  group: ${{ github.workflow }}-${{ github.ref }}\n  cancel-in-progress: true\n"
        },
        {
          "action": "unselect"
        },
        {
          "action": "highlight",
          "path": ".github/workflows/ci.yml",
          "position": "11:13"
        },
        {
          "action": "waitForTimeout",
          "timeout": 2000
        },
        {
          "action": "showInfoMessage",
          "message": "âœ… Workflow hardened! Actions pinned, permissions restricted, credentials protected"
        },
        {
          "action": "save"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git add .github/workflows/ci.yml",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git commit -m 'chore: Upgrade to pedantic hardening level'",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "git push",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "openTerminal",
          "terminalId": "demo"
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "command": "clear &&zizmor -p --gh-token $(gh auth token) .",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50,
          "terminalId": "demo"
        },
        {
          "action": "waitForTimeout",
          "timeout": 10000
        },
        {
          "action": "executeVSCodeCommand",
          "command": "workbench.action.toggleMaximizedPanel"
        },
        {
          "action": "executeTerminalCommand",
          "terminalId": "git",
          "command": "gh pr view --web",
          "insertTypingMode": "character-by-character",
          "insertTypingSpeed": 50
        },
        {
          "action": "showInfoMessage",
          "message": "âœ… Changes committed and pushed to the branch!"
        }
      ]
    }
  ]
}